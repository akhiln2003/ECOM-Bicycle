<%- include('../layout/user/header.ejs') %>

<style>
    .header-bottom {
        background-color: #000;
        width: 100%;
        position: fixed;
        top: 0;
        z-index: 1000;
        transition: background-color 0.3s ease-in-out;
    }

    .header-bottom.sticky {
        background-color: #000;
        /* Change this to your desired background color */
    }

    .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 1rem;
    }

    .logo {
        width: 10%;
    }

    .mainmenu {
        width: 70%; /* Adjust this width to your preference */
    }

    .mainmenu nav {
        display: flex;
        align-items: center;
    }

    .menu-list {
        display: flex;
        justify-content: center; /* Align items in the center horizontally */
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .menu-list li {
        margin-left: 1rem;
        position: relative;
    }

    .menu-list li a {
        text-decoration: none;
        color: white;
    }

    .menu-list li .submenu {
        display: none;
        position: absolute;
        background: white;
        color: black;
        list-style: none;
        padding: 0.5rem;
    }

    .menu-list li:hover .submenu {
        display: block;
    }

    .cart-menu-area {
        margin-left: auto;
        display: flex;
        align-items: center;
    }

    .cart-menu-area .fa-user,
    .cart-menu-area .fa-cart-shopping {
        font-size: 3ex; /* Adjust the size to your preference */
        margin-right: 1rem; /* Add margin to create space between icons */
    }

    .cart-menu-area .cart-menu-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center; /* Center the login button */
    }
</style>



<header>
    <div id="sticky-menu" class="header-bottom">
        <div class="row" >
            
            <div class="mainmenu" style="width: 100%;">
                <nav>
                    <div class="logo">
                        <a href="/">
                            <img src="/img/Wide White.jpg" width="100%" height="100% "  />
                        </a>
                    </div>
                    <ul class="menu-list" style="margin-left: 15%;">
                        <li><a href="/">Home</a></li>
                        <li><a href="/about">about</a></li>
                        <li><a href="#">Pages</a>
                            <ul class="submenu">
                                <li><a href="/profile">My account</a></li>
                                <li><a href="/wishlist">Wishlist</a></li>
                                <li><a href="/cart">Cart</a></li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/contact">Contact</a></li>
                                <li><a href="/shop">Shop</a></li>
                                <li><a href="product-details.html">Product Details</a></li>
                            </ul>
                        </li>
                        <li><a href="/contact">contact</a></li>
                    </ul>
					
						<input  type="text" id="search" placeholder="Search..."
							style="  width: 15%; margin-left: 10%; color: #000000; background-color: rgb(209, 209, 209); border: 1px solid #ffffff; border-radius: 5px;">

					
                    <div class="cart-menu-area">
                        <ul>
                            <li class="user-icon-dropdown">
                                <% if(locals.user){ %>
                                <a href="/profile"><i class="fa-regular fa-user"></i></a>
                                <ul class="cart-menu">
                                    <li class="cart-menu-btn">
                                        <a href="/logout">Logout</a>
                                        <a href="/profile">Profile</a>
                                    </li>
                                </ul>
                                <% } else { %>
                                <a href="/login"><i class="fa-regular fa-user"></i></a>
                                <ul class="cart-menu">
                                    <li class="cart-menu-btn">
                                        <a href="/login">Login</a>
                                    </li>
                                </ul>
                                <% } %>
                            </li>
                            <li>
                                <a href="/cart">
                                    <i class="fa-solid fa-cart-shopping"></i>
                                    <% if(locals.cartDetais && cartDetais.products && cartDetais.products.length > 0 ){ %>
                                    <span><%= locals.cartDetais.products.length %></span>
                                    <% } %>
                                </a>
                                <ul class="cart-menu">
                                    <li class="cart-menu-btn">
                                        <a href="/cart">view cart</a>
                                        <a href="/wishlist">view wishlist</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
            <!-- mobile menu start -->
            <div class="mobile-menu-area ">
                <div class="mobile-menu">
                     <div >
                        <a href="/">
                            <img  style="width:10%; margin-top: 1rem;" src="/img/Wide White.jpg"  />
                        </a>
                    </div>
                    <nav id="dropdown">
                        <ul>
                            <%if (locals.user){ %>
                                <li class="cart-menu-btn">
                                    <a href="/logout">Logout</a>
                                </li>
                                <% }else{ %>
                                    <li class="cart-menu-btn">
                                        <a href="/login">Login</a>
                                    </li><% }%>
                           
                            <li><a href="/">Home</a></li>
                            <li><a href="/about">about</a></li>
                            <li><a href="#">Pages</a>
                                <ul>
                                    <li><a href="/profile">My account</a></li>
                                    <li><a href="/wishlist">Wishlist</a></li>
                                    <li><a href="/cart">Cart</a></li>
                                    <li><a href="/about">About</a></li>
                                    <li><a href="/contact">Contact</a></li>
                                    <li><a href="/shop">Shop</a></li>
                                    <li><a href="product-details.html">Product Details</a></li>
                                </ul>
                            </li>
                            <li><a href="/contact">contact</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
            <!-- mobile menu end -->
        </div>
    </div>
</header>
	<style>
		.header-bottom {
			background-color: #000;
			width: 100%;
			position: fixed;
			top: 0;
			z-index: 1000;
			transition: background-color 0.3s ease-in-out;
		}

		.header-bottom.sticky {
			background-color: #000;
			/* Change this to your desired background color */
		}
	</style>

	<section class="product-content section-padding" style="margin-top: 30px;">
		<!-- Breadcrumb Section -->
		<section class="breadcrumb-section">
			<div class="container">
				<div class="row">
					<div class="col-12">
						<h2>Shop</h2>
						<div class="breadcrumb-text">
							<a style="color: black; text-decoration: none;" href="/">Home</a> >
							<span>Shop</span>
						</div>
					</div>
				</div>
			</div>
		</section>
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="shop-menu clearfix">
						
						<div class="right floatright">
							<ul>

								<li>
									<div class="custom-select" style="margin-top: 5px;">
										<select class="form-control" id="category" onchange="updateURL(this.value)">
											<option value="">Select</option>
											<% for(let i=0; i < category.length; i++) { %>
												<option value="<%= category[i].categoryName %>">
													<%= category[i].categoryName %>
												</option>
												<% } %>
										</select>

									</div>
									<p><strong>Categoty</strong></p>
								</li>


								<li>
									<div class="custom-select" style="margin-top: 5px;">
										<select class="form-control" id="sortby" onchange="updatesort(this.value)">
											<option value="">Select</option>
											<option value="Aa-Zz">Aa - Zz</option>
											<option value="Low-High">Price Low to High </option>
											<option value="High-Low">Price High to Low</option>
											<option value="NewArivals">New Arivals</option>
										</select>
									</div>
									<p> <strong>Short By</strong></p>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="tab-content">
					<div class="tab-pane fade show active text-center" id="grid">
						<div class="single-products row">
							<% if(Array.isArray(products)){ %>
								<% products.forEach((product,index)=>{ %>

									<div class="col-md-4">
										<div class="product-item margin40">
											<div class="pro-img">
												<a href="/productDetails?id=<%= product._id %>"><img
														src="/admin/assets/images/product/sharpedproduct/<%= product.image[0] %>"
														width="360" height="409" alt="Product" /></a>
												

											</div>
											<div class="product-title">
												<a href="product-details.html">
													<h3 class="title">
														<%= product.productName %>
													</h3>
												</a>
												<div class="ratting">
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star gray-star"></i>
												</div>
												<p><span> ₹ <%= product.productPrice %></span></p>
											</div>
										</div>

									</div>
									<% }) %>
										<%}%>

						</div>
					</div>

				</div>
			</div>
			<div class="row">
				<div class="col-12">
					<div class="shop-menu clearfix margin-close">
						<div class="right floatright text-center">
							<div class="pagnation-ul">
								<ul class="clearfix">

									<li>
										<a onclick="updatePage('<%= previous %>')"><i class="fa fa-angle-left"></i></a>
									</li>
									<% for(let i=1; i <=totalPages; i++) { %>
										<li>
											<a href="#" onclick="updatePage('<%= i %>')">
												<%= i %>
											</a>
										</li>
										<% } %>
											<li>
												<a href="#" onclick="updatePage('<%= next %>')"><i
														class="fa fa-angle-right"></i></a>
											</li>

								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>



	<script>




		function updateURL(categoryName) {
			// Get the current URL
			let currentURL = new URL(window.location.href);

			// Remove existing sort parameter if it exists
			currentURL.searchParams.delete('category');

			// Set the new sort parameter with the selected value
			if (categoryName) {
				currentURL.searchParams.set('category', categoryName);
			}

			// Redirect to the updated URL
			window.location.href = currentURL.toString();
		}

		function updatesort(value) {
			// Get the current URL
			let currentURL = new URL(window.location.href);

			currentURL.searchParams.delete('sort');

			if (value) {
				currentURL.searchParams.set('sort', value);
			}

			// Redirect to the updated URL
			window.location.href = currentURL.toString();
		}


		function updatePage(action) {
			let currentURL = new URL(window.location.href);
			let existingPage = parseInt(currentURL.searchParams.get('page')) || 1; // Parse the existingPage to integer and default to 1
			let newPage;

			if (action === 'next') {
				newPage = existingPage + 1;
			} else if (action === 'previous') {
				newPage = existingPage - 1;
			} else {
				newPage = parseInt(action) || 1; // Parse action to integer and default to 1
			}

			// Ensure newPage is within valid range
			if (newPage < 1) {
				newPage = 1;
			}

			// Set or append the 'page' parameter in the URL
			currentURL.searchParams.set('page', newPage);

			// Remove the fragment identifier (hash)
			currentURL.hash = '';

			// Update the window location
			window.location.href = currentURL.toString();
		}

	</script>



	<script>
		document.addEventListener("DOMContentLoaded", function () {

			function getsortFromUrl() {
				const urlParams = new URLSearchParams(window.location.search);

				return urlParams.get('sort');
			}


			function getCategoryIdFromUrl() {
				const urlParams = new URLSearchParams(window.location.search);

				return urlParams.get('category');
			}

			// Function to set the selected option based on the category ID
			function setSelectedSort(sort) {
				const selectElement = document.getElementById('sortby');


				const options = selectElement.options;


				for (let i = 0; i < options.length; i++) {
					if (options[i].value.includes(sort)) {
						selectElement.value = options[i].value;
						break;
					}
				}

			}

			function setSelectedCategory(categoryId) {
				const selectElement = document.getElementById('category');


				const options = selectElement.options;


				for (let i = 0; i < options.length; i++) {
					if (options[i].value.includes(categoryId)) {
						selectElement.value = options[i].value;
						break;
					}
				}

			}

			// Get the category ID from the URL and set the selected option
			const sort = getsortFromUrl();
			if (sort) {
				setSelectedSort(sort);
			}
			const category = getCategoryIdFromUrl();
			if (category) {
				setSelectedCategory(category);
			}
		});


		document.addEventListener("DOMContentLoaded", function () {
    const searchInput = document.getElementById('search');
    const products = document.querySelectorAll('.single-products .col-md-4');

    searchInput.addEventListener("input", function () {
        const searchString = searchInput.value.trim().toLowerCase(); // Convert search string to lowercase

        products.forEach(product => {
            const productName = product.querySelector('.product-title h3').innerText.toLowerCase(); // Convert product name to lowercase
            const firstLetters = productName.slice(0, searchString.length);

            // Check if the first letters of the lowercase product name match the lowercase search string
            if (firstLetters === searchString) {
                product.style.display = "block";
            } else {
                product.style.display = "none";
            }
        });
    });
});



	</script>




	
	<%- include('../layout/user/footbar.ejs') %>
		<%- include('../layout/user/footer.ejs') %>